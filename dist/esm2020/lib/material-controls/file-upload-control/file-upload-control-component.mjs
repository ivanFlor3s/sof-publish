import { Component, Input, ViewChild } from '@angular/core';
import { FileUploadControlComponent } from '../../base/file-upload-control/file-upload-control.component';
import { FileInput } from 'ngx-material-file-input';
import { ValidationTypes } from '../../validations';
import { ErrorMaterialComponent } from '../error/error.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/form-field";
import * as i2 from "@angular/material/icon";
import * as i3 from "ngx-material-file-input";
import * as i4 from "@angular/material/chips";
import * as i5 from "../error/error.component";
import * as i6 from "@angular/common";
export class FileUploadMaterialControlComponent extends FileUploadControlComponent {
    ngOnInit() {
        document.querySelectorAll('ngx-mat-file-input[data-selector="mat-input-file"] input[type="file"]').forEach(e => e.addEventListener('focus', e => {
            document.getElementById('mat-input-file')?.classList.remove('cdk-focused', 'cdk-keyboard-focused', 'mat-form-field-should-float');
            this.Field._changeDetectorRef._cdRefInjectingView[0]?.classList.remove('mat-form-field-should-float');
            this.Field._changeDetectorRef._cdRefInjectingView[0]?.classList.add('mat-form-field-hide-placeholder');
        }));
        // this.redrawFields(this.value)
    }
    onInput(value) {
        value = this.normalizeValue(value);
        this.changeValue(value);
        // this.redrawFields(value)
    }
    redrawFields(value) {
        // console.log(!!value && value.length > 0 )
        // if(!!value && value.length > 0 ) {
        //   (this.Field._changeDetectorRef._cdRefInjectingView[0] as HTMLElement).style.display = 'none';
        // } 
        // // else if( value  && !this.multiple) {
        // //   (this.Field._changeDetectorRef._cdRefInjectingView[0] as HTMLElement).style.display = 'none';
        // // } 
    }
    getMaxSizeValueInValidation(validations) {
        if (validations) {
            return validations.find(x => x.type == ValidationTypes.MaxFileSize)?.value;
        }
        else
            return 0;
    }
    getFileInputFromValue() {
        if (this.value instanceof File)
            return new FileInput([this.value]);
        else
            return new FileInput(this.value);
    }
    getFilesName() {
        const files = this.getFileInputFromValue();
        return files.fileNames ? files.fileNames.split(',') : [];
    }
    deleteItem(key) {
        if (this.multiple) {
            this.value = this.value.filter((f) => f.name != key);
        }
        else {
            this.value = null;
        }
        // if( !this.value || this.value.length < 1 ) {
        //   (this.Field._changeDetectorRef._cdRefInjectingView[0] as HTMLElement).style.display = 'inline-block';
        // }
    }
}
FileUploadMaterialControlComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: FileUploadMaterialControlComponent, deps: null, target: i0.ɵɵFactoryTarget.Component });
FileUploadMaterialControlComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: FileUploadMaterialControlComponent, selector: "sof-file-upload-control", inputs: { maxSize: "maxSize" }, viewQueries: [{ propertyName: "Field", first: true, predicate: ["field"], descendants: true }, { propertyName: "errorControl", first: true, predicate: ErrorMaterialComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: "<mat-form-field  appearance=\"outline\" #field  *ngIf=\"!(getFilesName().length > 0)\" >\r\n  <mat-label [ngClass]=\"{\r\n    'required-label': isRequired,\r\n    'text-error': EsInvalido\r\n  }\">\r\n  <mat-icon matSuffix>attachment</mat-icon>\r\n  {{ label }}\r\n  </mat-label>\r\n\r\n  <ngx-mat-file-input \r\n    data-selector=\"mat-input-file\"\r\n    matInput\r\n    class=\"form-control\"\r\n    [disabled]=\"disabled || !!readOnly\"\r\n    type=\"file\"\r\n    [multiple]=\"!!multiple\"\r\n    [value]=\"getFileInputFromValue()\"\r\n    [accept]=\"accept\"\r\n    (change)=\"onInput( !!multiple ? $any($event.target).files : $any($event.target).files[0] )\">\r\n  </ngx-mat-file-input>\r\n\r\n  \r\n</mat-form-field>\r\n\r\n<div  *ngIf=\"getFilesName().length > 0\" class=\"row\">\r\n  <div>\r\n    <mat-chip-list *ngFor=\"let file of getFilesName()\">\r\n      <mat-chip >\r\n        {{ file }}\r\n        <button matChipRemove (click)=\"deleteItem(file)\">\r\n          <mat-icon>cancel</mat-icon>\r\n        </button>\r\n      </mat-chip>\r\n    </mat-chip-list>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n<sof-error [controlInvalido]=\"EsInvalido\" [label]=\"label\" [errors]=\"errors\"></sof-error>\r\n", styles: [":host{display:flex;flex-direction:column}:host mat-label{display:flex;justify-content:center;align-items:center;font-size:1rem}:host mat-label.active-label{color:#673ab7}:host mat-label.text-error{color:red}:host mat-label.required-label:after{content:\"*\";color:red}:host mat-form-field.error-field div div div.mat-form-field-outline{color:red}:host mat-icon{transform:rotate(270deg);font-size:1.5em;margin-right:.5em}:host .row{width:100%}\n"], components: [{ type: i1.MatFormField, selector: "mat-form-field", inputs: ["color", "appearance", "hideRequiredMarker", "hintLabel", "floatLabel"], exportAs: ["matFormField"] }, { type: i2.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { type: i3.FileInputComponent, selector: "ngx-mat-file-input", inputs: ["autofilled", "valuePlaceholder", "accept", "errorStateMatcher", "value", "multiple", "placeholder", "required", "disabled"] }, { type: i4.MatChipList, selector: "mat-chip-list", inputs: ["errorStateMatcher", "multiple", "compareWith", "value", "required", "placeholder", "disabled", "aria-orientation", "selectable", "tabIndex"], outputs: ["change", "valueChange"], exportAs: ["matChipList"] }, { type: i5.ErrorMaterialComponent, selector: "sof-error" }], directives: [{ type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i1.MatLabel, selector: "mat-label" }, { type: i6.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i1.MatSuffix, selector: "[matSuffix]" }, { type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i4.MatChip, selector: "mat-basic-chip, [mat-basic-chip], mat-chip, [mat-chip]", inputs: ["color", "disableRipple", "tabIndex", "selected", "value", "selectable", "disabled", "removable"], outputs: ["selectionChange", "destroyed", "removed"], exportAs: ["matChip"] }, { type: i4.MatChipRemove, selector: "[matChipRemove]" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: FileUploadMaterialControlComponent, decorators: [{
            type: Component,
            args: [{ selector: 'sof-file-upload-control', template: "<mat-form-field  appearance=\"outline\" #field  *ngIf=\"!(getFilesName().length > 0)\" >\r\n  <mat-label [ngClass]=\"{\r\n    'required-label': isRequired,\r\n    'text-error': EsInvalido\r\n  }\">\r\n  <mat-icon matSuffix>attachment</mat-icon>\r\n  {{ label }}\r\n  </mat-label>\r\n\r\n  <ngx-mat-file-input \r\n    data-selector=\"mat-input-file\"\r\n    matInput\r\n    class=\"form-control\"\r\n    [disabled]=\"disabled || !!readOnly\"\r\n    type=\"file\"\r\n    [multiple]=\"!!multiple\"\r\n    [value]=\"getFileInputFromValue()\"\r\n    [accept]=\"accept\"\r\n    (change)=\"onInput( !!multiple ? $any($event.target).files : $any($event.target).files[0] )\">\r\n  </ngx-mat-file-input>\r\n\r\n  \r\n</mat-form-field>\r\n\r\n<div  *ngIf=\"getFilesName().length > 0\" class=\"row\">\r\n  <div>\r\n    <mat-chip-list *ngFor=\"let file of getFilesName()\">\r\n      <mat-chip >\r\n        {{ file }}\r\n        <button matChipRemove (click)=\"deleteItem(file)\">\r\n          <mat-icon>cancel</mat-icon>\r\n        </button>\r\n      </mat-chip>\r\n    </mat-chip-list>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n<sof-error [controlInvalido]=\"EsInvalido\" [label]=\"label\" [errors]=\"errors\"></sof-error>\r\n", styles: [":host{display:flex;flex-direction:column}:host mat-label{display:flex;justify-content:center;align-items:center;font-size:1rem}:host mat-label.active-label{color:#673ab7}:host mat-label.text-error{color:red}:host mat-label.required-label:after{content:\"*\";color:red}:host mat-form-field.error-field div div div.mat-form-field-outline{color:red}:host mat-icon{transform:rotate(270deg);font-size:1.5em;margin-right:.5em}:host .row{width:100%}\n"] }]
        }], propDecorators: { maxSize: [{
                type: Input
            }], Field: [{
                type: ViewChild,
                args: ['field', { static: false }]
            }], errorControl: [{
                type: ViewChild,
                args: [ErrorMaterialComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb250cm9scy9zcmMvbGliL21hdGVyaWFsLWNvbnRyb2xzL2ZpbGUtdXBsb2FkLWNvbnRyb2wvZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb250cm9scy9zcmMvbGliL21hdGVyaWFsLWNvbnRyb2xzL2ZpbGUtdXBsb2FkLWNvbnRyb2wvZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBb0MsU0FBUyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzlGLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLDhEQUE4RCxDQUFDO0FBQzFHLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUNwRCxPQUFPLEVBQUMsZUFBZSxFQUFHLE1BQU0sbUJBQW1CLENBQUE7QUFFbkQsT0FBTyxFQUFFLHNCQUFzQixFQUFFLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7O0FBT2xFLE1BQU0sT0FBTyxrQ0FBbUMsU0FBUSwwQkFBMEI7SUFPaEYsUUFBUTtRQUNOLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyx1RUFBdUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLEVBQUU7WUFFOUksUUFBUSxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsYUFBYSxFQUFFLHNCQUFzQixFQUFFLDZCQUE2QixDQUFDLENBQUE7WUFDakksSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsTUFBTSxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFDdEcsSUFBSSxDQUFDLEtBQUssQ0FBQyxrQkFBa0IsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLENBQUMsRUFBRSxTQUFTLENBQUMsR0FBRyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7UUFDekcsQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUNILGdDQUFnQztJQUNsQyxDQUFDO0lBRVEsT0FBTyxDQUFDLEtBQVU7UUFDekIsS0FBSyxHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFbkMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QiwyQkFBMkI7SUFDN0IsQ0FBQztJQUVELFlBQVksQ0FBQyxLQUFVO1FBRXJCLDRDQUE0QztRQUM1QyxxQ0FBcUM7UUFDckMsa0dBQWtHO1FBQ2xHLEtBQUs7UUFDTCwwQ0FBMEM7UUFDMUMscUdBQXFHO1FBQ3JHLFFBQVE7SUFFVixDQUFDO0lBR0QsMkJBQTJCLENBQUMsV0FBOEI7UUFDeEQsSUFBRyxXQUFXLEVBQUM7WUFDYixPQUFPLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFBLEVBQUUsQ0FBQSxDQUFDLENBQUMsSUFBSSxJQUFHLGVBQWUsQ0FBQyxXQUFXLENBQUMsRUFBRSxLQUFLLENBQUE7U0FDeEU7O1lBQ0ksT0FBTyxDQUFDLENBQUE7SUFDZixDQUFDO0lBRUQscUJBQXFCO1FBQ25CLElBQUksSUFBSSxDQUFDLEtBQUssWUFBWSxJQUFJO1lBQzVCLE9BQU8sSUFBSSxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQzs7WUFFbkMsT0FBTyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDckMsQ0FBQztJQUVELFlBQVk7UUFDVixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQztRQUMzQyxPQUFPLEtBQUssQ0FBQyxTQUFTLENBQUEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDMUQsQ0FBQztJQUVELFVBQVUsQ0FBQyxHQUFXO1FBQ3BCLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtZQUNqQixJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFFLENBQUMsQ0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFBO1NBQzVEO2FBQU07WUFDTCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQTtTQUNsQjtRQUVELCtDQUErQztRQUMvQywwR0FBMEc7UUFDMUcsSUFBSTtJQUNOLENBQUM7OytIQWxFVSxrQ0FBa0M7bUhBQWxDLGtDQUFrQyw4TkFJbEMsc0JBQXNCLHVFQ2hCbkMsMnJDQXdDQTsyRkQ1QmEsa0NBQWtDO2tCQUw5QyxTQUFTOytCQUNFLHlCQUF5Qjs4QkFNMUIsT0FBTztzQkFBZixLQUFLO2dCQUMrQixLQUFLO3NCQUF6QyxTQUFTO3VCQUFDLE9BQU8sRUFBRSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUM7Z0JBQ0EsWUFBWTtzQkFBOUMsU0FBUzt1QkFBQyxzQkFBc0IiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCwgU2ltcGxlQ2hhbmdlcywgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IEZpbGVVcGxvYWRDb250cm9sQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vYmFzZS9maWxlLXVwbG9hZC1jb250cm9sL2ZpbGUtdXBsb2FkLWNvbnRyb2wuY29tcG9uZW50JztcclxuaW1wb3J0IHsgRmlsZUlucHV0IH0gZnJvbSAnbmd4LW1hdGVyaWFsLWZpbGUtaW5wdXQnO1xyXG5pbXBvcnQge1ZhbGlkYXRpb25UeXBlcyAgfSBmcm9tICcuLi8uLi92YWxpZGF0aW9ucydcclxuaW1wb3J0IHtWYWxpZGF0aW9uRm9ybX0gZnJvbSAnLi4vLi4vZHluYW1pYy1mb3JtL2ludGVyZmFjZXMnXHJcbmltcG9ydCB7IEVycm9yTWF0ZXJpYWxDb21wb25lbnQgfSBmcm9tICcuLi9lcnJvci9lcnJvci5jb21wb25lbnQnO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdzb2YtZmlsZS11cGxvYWQtY29udHJvbCcsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2ZpbGUtdXBsb2FkLWNvbnRyb2wtY29tcG9uZW50Lmh0bWwnLFxyXG4gIHN0eWxlVXJsczogWycuL2ZpbGUtdXBsb2FkLWNvbnRyb2wtY29tcG9uZW50LnNjc3MnXSxcclxufSlcclxuZXhwb3J0IGNsYXNzIEZpbGVVcGxvYWRNYXRlcmlhbENvbnRyb2xDb21wb25lbnQgZXh0ZW5kcyBGaWxlVXBsb2FkQ29udHJvbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XHJcbiAgXHJcbiAgQElucHV0KCkgbWF4U2l6ZSE6bnVtYmVyXHJcbiAgQFZpZXdDaGlsZCgnZmllbGQnLCB7c3RhdGljOiBmYWxzZX0pIEZpZWxkOiBhbnk7XHJcbiAgQFZpZXdDaGlsZChFcnJvck1hdGVyaWFsQ29tcG9uZW50KSBlcnJvckNvbnRyb2w6IEVycm9yTWF0ZXJpYWxDb21wb25lbnRcclxuICBcclxuICBcclxuICBuZ09uSW5pdCgpOiB2b2lkIHtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ25neC1tYXQtZmlsZS1pbnB1dFtkYXRhLXNlbGVjdG9yPVwibWF0LWlucHV0LWZpbGVcIl0gaW5wdXRbdHlwZT1cImZpbGVcIl0nKS5mb3JFYWNoKGUgPT4gZS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIGUgPT4ge1xyXG5cclxuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hdC1pbnB1dC1maWxlJyk/LmNsYXNzTGlzdC5yZW1vdmUoJ2Nkay1mb2N1c2VkJywgJ2Nkay1rZXlib2FyZC1mb2N1c2VkJywgJ21hdC1mb3JtLWZpZWxkLXNob3VsZC1mbG9hdCcpXHJcbiAgICAgIHRoaXMuRmllbGQuX2NoYW5nZURldGVjdG9yUmVmLl9jZFJlZkluamVjdGluZ1ZpZXdbMF0/LmNsYXNzTGlzdC5yZW1vdmUoJ21hdC1mb3JtLWZpZWxkLXNob3VsZC1mbG9hdCcpO1xyXG4gICAgICB0aGlzLkZpZWxkLl9jaGFuZ2VEZXRlY3RvclJlZi5fY2RSZWZJbmplY3RpbmdWaWV3WzBdPy5jbGFzc0xpc3QuYWRkKCdtYXQtZm9ybS1maWVsZC1oaWRlLXBsYWNlaG9sZGVyJyk7XHJcbiAgICB9KSlcclxuICAgIC8vIHRoaXMucmVkcmF3RmllbGRzKHRoaXMudmFsdWUpXHJcbiAgfVxyXG4gIFxyXG4gIG92ZXJyaWRlIG9uSW5wdXQodmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgdmFsdWUgPSB0aGlzLm5vcm1hbGl6ZVZhbHVlKHZhbHVlKTtcclxuXHJcbiAgICB0aGlzLmNoYW5nZVZhbHVlKHZhbHVlKTtcclxuICAgIC8vIHRoaXMucmVkcmF3RmllbGRzKHZhbHVlKVxyXG4gIH1cclxuICBcclxuICByZWRyYXdGaWVsZHModmFsdWU6IGFueSkge1xyXG4gICAgXHJcbiAgICAvLyBjb25zb2xlLmxvZyghIXZhbHVlICYmIHZhbHVlLmxlbmd0aCA+IDAgKVxyXG4gICAgLy8gaWYoISF2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwICkge1xyXG4gICAgLy8gICAodGhpcy5GaWVsZC5fY2hhbmdlRGV0ZWN0b3JSZWYuX2NkUmVmSW5qZWN0aW5nVmlld1swXSBhcyBIVE1MRWxlbWVudCkuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgIC8vIH0gXHJcbiAgICAvLyAvLyBlbHNlIGlmKCB2YWx1ZSAgJiYgIXRoaXMubXVsdGlwbGUpIHtcclxuICAgIC8vIC8vICAgKHRoaXMuRmllbGQuX2NoYW5nZURldGVjdG9yUmVmLl9jZFJlZkluamVjdGluZ1ZpZXdbMF0gYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAvLyAvLyB9IFxyXG5cclxuICB9XHJcblxyXG5cclxuICBnZXRNYXhTaXplVmFsdWVJblZhbGlkYXRpb24odmFsaWRhdGlvbnM/OiBWYWxpZGF0aW9uRm9ybVtdKXtcclxuICAgIGlmKHZhbGlkYXRpb25zKXtcclxuICAgICAgcmV0dXJuIHZhbGlkYXRpb25zLmZpbmQoeD0+eC50eXBlPT0gVmFsaWRhdGlvblR5cGVzLk1heEZpbGVTaXplKT8udmFsdWVcclxuICAgIH1cclxuICAgIGVsc2UgcmV0dXJuIDBcclxuICB9XHJcblxyXG4gIGdldEZpbGVJbnB1dEZyb21WYWx1ZSgpOiBGaWxlSW5wdXQge1xyXG4gICAgaWYgKHRoaXMudmFsdWUgaW5zdGFuY2VvZiBGaWxlKVxyXG4gICAgICByZXR1cm4gbmV3IEZpbGVJbnB1dChbdGhpcy52YWx1ZV0pO1xyXG4gICAgZWxzZVxyXG4gICAgICByZXR1cm4gbmV3IEZpbGVJbnB1dCh0aGlzLnZhbHVlKTtcclxuICB9XHJcblxyXG4gIGdldEZpbGVzTmFtZSgpOiBzdHJpbmdbXSB7XHJcbiAgICBjb25zdCBmaWxlcyA9IHRoaXMuZ2V0RmlsZUlucHV0RnJvbVZhbHVlKCk7XHJcbiAgICByZXR1cm4gZmlsZXMuZmlsZU5hbWVzPyBmaWxlcy5maWxlTmFtZXMuc3BsaXQoJywnKSA6IFtdO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlSXRlbShrZXk6IHN0cmluZykge1xyXG4gICAgaWYoIHRoaXMubXVsdGlwbGUgKXtcclxuICAgICAgdGhpcy52YWx1ZSA9IHRoaXMudmFsdWUuZmlsdGVyKCAoZjogRmlsZSkgPT4gZi5uYW1lICE9IGtleSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMudmFsdWUgPSBudWxsXHJcbiAgICB9XHJcblxyXG4gICAgLy8gaWYoICF0aGlzLnZhbHVlIHx8IHRoaXMudmFsdWUubGVuZ3RoIDwgMSApIHtcclxuICAgIC8vICAgKHRoaXMuRmllbGQuX2NoYW5nZURldGVjdG9yUmVmLl9jZFJlZkluamVjdGluZ1ZpZXdbMF0gYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnaW5saW5lLWJsb2NrJztcclxuICAgIC8vIH1cclxuICB9XHJcbn1cclxuIiwiPG1hdC1mb3JtLWZpZWxkICBhcHBlYXJhbmNlPVwib3V0bGluZVwiICNmaWVsZCAgKm5nSWY9XCIhKGdldEZpbGVzTmFtZSgpLmxlbmd0aCA+IDApXCIgPlxyXG4gIDxtYXQtbGFiZWwgW25nQ2xhc3NdPVwie1xyXG4gICAgJ3JlcXVpcmVkLWxhYmVsJzogaXNSZXF1aXJlZCxcclxuICAgICd0ZXh0LWVycm9yJzogRXNJbnZhbGlkb1xyXG4gIH1cIj5cclxuICA8bWF0LWljb24gbWF0U3VmZml4PmF0dGFjaG1lbnQ8L21hdC1pY29uPlxyXG4gIHt7IGxhYmVsIH19XHJcbiAgPC9tYXQtbGFiZWw+XHJcblxyXG4gIDxuZ3gtbWF0LWZpbGUtaW5wdXQgXHJcbiAgICBkYXRhLXNlbGVjdG9yPVwibWF0LWlucHV0LWZpbGVcIlxyXG4gICAgbWF0SW5wdXRcclxuICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcclxuICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZCB8fCAhIXJlYWRPbmx5XCJcclxuICAgIHR5cGU9XCJmaWxlXCJcclxuICAgIFttdWx0aXBsZV09XCIhIW11bHRpcGxlXCJcclxuICAgIFt2YWx1ZV09XCJnZXRGaWxlSW5wdXRGcm9tVmFsdWUoKVwiXHJcbiAgICBbYWNjZXB0XT1cImFjY2VwdFwiXHJcbiAgICAoY2hhbmdlKT1cIm9uSW5wdXQoICEhbXVsdGlwbGUgPyAkYW55KCRldmVudC50YXJnZXQpLmZpbGVzIDogJGFueSgkZXZlbnQudGFyZ2V0KS5maWxlc1swXSApXCI+XHJcbiAgPC9uZ3gtbWF0LWZpbGUtaW5wdXQ+XHJcblxyXG4gIFxyXG48L21hdC1mb3JtLWZpZWxkPlxyXG5cclxuPGRpdiAgKm5nSWY9XCJnZXRGaWxlc05hbWUoKS5sZW5ndGggPiAwXCIgY2xhc3M9XCJyb3dcIj5cclxuICA8ZGl2PlxyXG4gICAgPG1hdC1jaGlwLWxpc3QgKm5nRm9yPVwibGV0IGZpbGUgb2YgZ2V0RmlsZXNOYW1lKClcIj5cclxuICAgICAgPG1hdC1jaGlwID5cclxuICAgICAgICB7eyBmaWxlIH19XHJcbiAgICAgICAgPGJ1dHRvbiBtYXRDaGlwUmVtb3ZlIChjbGljayk9XCJkZWxldGVJdGVtKGZpbGUpXCI+XHJcbiAgICAgICAgICA8bWF0LWljb24+Y2FuY2VsPC9tYXQtaWNvbj5cclxuICAgICAgICA8L2J1dHRvbj5cclxuICAgICAgPC9tYXQtY2hpcD5cclxuICAgIDwvbWF0LWNoaXAtbGlzdD5cclxuICA8L2Rpdj5cclxuPC9kaXY+XHJcblxyXG5cclxuXHJcbjxzb2YtZXJyb3IgW2NvbnRyb2xJbnZhbGlkb109XCJFc0ludmFsaWRvXCIgW2xhYmVsXT1cImxhYmVsXCIgW2Vycm9yc109XCJlcnJvcnNcIj48L3NvZi1lcnJvcj5cclxuIl19