import { Component, Input, ViewChild } from '@angular/core';
import { FileUploadControlComponent } from '../../base/file-upload-control/file-upload-control.component';
import { FileInput } from 'ngx-material-file-input';
import { ValidationTypes } from '../../validations';
import { ErrorMaterialComponent } from '../error/error.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/form-field";
import * as i2 from "@angular/material/icon";
import * as i3 from "ngx-material-file-input";
import * as i4 from "@angular/material/chips";
import * as i5 from "../error/error.component";
import * as i6 from "@angular/common";
export class FileUploadMaterialControlComponent extends FileUploadControlComponent {
    ngOnInit() {
        document.querySelectorAll('ngx-mat-file-input[data-selector="mat-input-file"] input[type="file"]').forEach(e => e.addEventListener('focus', e => {
            document.getElementById('mat-input-file')?.classList.remove('cdk-focused', 'cdk-keyboard-focused', 'mat-form-field-should-float');
            this.Field._changeDetectorRef._cdRefInjectingView[0]?.classList.remove('mat-form-field-should-float');
            this.Field._changeDetectorRef._cdRefInjectingView[0]?.classList.add('mat-form-field-hide-placeholder');
        }));
    }
    onInput(value) {
        value = this.normalizeValue(value);
        this.changeValue(value);
        if (this.multiple && value.length > 0) {
            this.Field._changeDetectorRef._cdRefInjectingView[0].style.display = 'none';
        }
        else if (value && !this.multiple) {
            this.Field._changeDetectorRef._cdRefInjectingView[0].style.display = 'none';
        }
    }
    getMaxSizeValueInValidation(validations) {
        if (validations) {
            return validations.find(x => x.type == ValidationTypes.MaxFileSize)?.value;
        }
        else
            return 0;
    }
    getFileInputFromValue() {
        if (this.value instanceof File)
            return new FileInput([this.value]);
        else
            return new FileInput(this.value);
    }
    getFilesName() {
        const files = this.getFileInputFromValue();
        return files.fileNames ? files.fileNames.split(',') : [];
    }
    deleteItem(key) {
        if (this.multiple) {
            this.value = this.value.filter((f) => f.name != key);
        }
        else {
            this.value = null;
        }
        if (!this.value || this.value.length < 1) {
            this.Field._changeDetectorRef._cdRefInjectingView[0].style.display = 'inline-block';
        }
    }
}
FileUploadMaterialControlComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: FileUploadMaterialControlComponent, deps: null, target: i0.ɵɵFactoryTarget.Component });
FileUploadMaterialControlComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.1.3", type: FileUploadMaterialControlComponent, selector: "sof-file-upload-control", inputs: { maxSize: "maxSize" }, viewQueries: [{ propertyName: "Field", first: true, predicate: ["field"], descendants: true }, { propertyName: "errorControl", first: true, predicate: ErrorMaterialComponent, descendants: true }], usesInheritance: true, ngImport: i0, template: "<mat-form-field  appearance=\"outline\" #field >\r\n  <mat-label [ngClass]=\"{\r\n    'required-label': isRequired,\r\n    'text-error': EsInvalido\r\n  }\">\r\n  <mat-icon matSuffix>attachment</mat-icon>\r\n  {{ label }}\r\n  </mat-label>\r\n\r\n  <ngx-mat-file-input \r\n    data-selector=\"mat-input-file\"\r\n    matInput\r\n    class=\"form-control\"\r\n    [disabled]=\"disabled\"\r\n    type=\"file\"\r\n    [multiple]=\"!!multiple\"\r\n    [value]=\"getFileInputFromValue()\"\r\n    [accept]=\"accept\"\r\n    (change)=\"onInput( !!multiple ? $any($event.target).files : $any($event.target).files[0] )\">\r\n  </ngx-mat-file-input>\r\n\r\n  \r\n</mat-form-field>\r\n\r\n<div  *ngIf=\"getFilesName().length > 0\" class=\"row\">\r\n  <div>\r\n    <mat-chip-list *ngFor=\"let file of getFilesName()\">\r\n      <mat-chip >\r\n        {{ file }}\r\n        <button matChipRemove (click)=\"deleteItem(file)\">\r\n          <mat-icon>cancel</mat-icon>\r\n        </button>\r\n      </mat-chip>\r\n    </mat-chip-list>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n<sof-error [controlInvalido]=\"EsInvalido\" [label]=\"label\" [errors]=\"errors\"></sof-error>\r\n", styles: [":host{display:flex;flex-direction:column}:host mat-label{display:flex;justify-content:center;align-items:center;font-size:1rem}:host mat-label.active-label{color:#673ab7}:host mat-label.text-error{color:red}:host mat-label.required-label:after{content:\"*\";color:red}:host mat-form-field.error-field div div div.mat-form-field-outline{color:red}:host mat-icon{transform:rotate(270deg);font-size:1.5em;margin-right:.5em}:host .row{width:100%}\n"], components: [{ type: i1.MatFormField, selector: "mat-form-field", inputs: ["color", "appearance", "hideRequiredMarker", "hintLabel", "floatLabel"], exportAs: ["matFormField"] }, { type: i2.MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { type: i3.FileInputComponent, selector: "ngx-mat-file-input", inputs: ["autofilled", "valuePlaceholder", "accept", "errorStateMatcher", "value", "multiple", "placeholder", "required", "disabled"] }, { type: i4.MatChipList, selector: "mat-chip-list", inputs: ["errorStateMatcher", "multiple", "compareWith", "value", "required", "placeholder", "disabled", "aria-orientation", "selectable", "tabIndex"], outputs: ["change", "valueChange"], exportAs: ["matChipList"] }, { type: i5.ErrorMaterialComponent, selector: "sof-error" }], directives: [{ type: i1.MatLabel, selector: "mat-label" }, { type: i6.NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { type: i1.MatSuffix, selector: "[matSuffix]" }, { type: i6.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { type: i6.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { type: i4.MatChip, selector: "mat-basic-chip, [mat-basic-chip], mat-chip, [mat-chip]", inputs: ["color", "disableRipple", "tabIndex", "selected", "value", "selectable", "disabled", "removable"], outputs: ["selectionChange", "destroyed", "removed"], exportAs: ["matChip"] }, { type: i4.MatChipRemove, selector: "[matChipRemove]" }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.1.3", ngImport: i0, type: FileUploadMaterialControlComponent, decorators: [{
            type: Component,
            args: [{ selector: 'sof-file-upload-control', template: "<mat-form-field  appearance=\"outline\" #field >\r\n  <mat-label [ngClass]=\"{\r\n    'required-label': isRequired,\r\n    'text-error': EsInvalido\r\n  }\">\r\n  <mat-icon matSuffix>attachment</mat-icon>\r\n  {{ label }}\r\n  </mat-label>\r\n\r\n  <ngx-mat-file-input \r\n    data-selector=\"mat-input-file\"\r\n    matInput\r\n    class=\"form-control\"\r\n    [disabled]=\"disabled\"\r\n    type=\"file\"\r\n    [multiple]=\"!!multiple\"\r\n    [value]=\"getFileInputFromValue()\"\r\n    [accept]=\"accept\"\r\n    (change)=\"onInput( !!multiple ? $any($event.target).files : $any($event.target).files[0] )\">\r\n  </ngx-mat-file-input>\r\n\r\n  \r\n</mat-form-field>\r\n\r\n<div  *ngIf=\"getFilesName().length > 0\" class=\"row\">\r\n  <div>\r\n    <mat-chip-list *ngFor=\"let file of getFilesName()\">\r\n      <mat-chip >\r\n        {{ file }}\r\n        <button matChipRemove (click)=\"deleteItem(file)\">\r\n          <mat-icon>cancel</mat-icon>\r\n        </button>\r\n      </mat-chip>\r\n    </mat-chip-list>\r\n  </div>\r\n</div>\r\n\r\n\r\n\r\n<sof-error [controlInvalido]=\"EsInvalido\" [label]=\"label\" [errors]=\"errors\"></sof-error>\r\n", styles: [":host{display:flex;flex-direction:column}:host mat-label{display:flex;justify-content:center;align-items:center;font-size:1rem}:host mat-label.active-label{color:#673ab7}:host mat-label.text-error{color:red}:host mat-label.required-label:after{content:\"*\";color:red}:host mat-form-field.error-field div div div.mat-form-field-outline{color:red}:host mat-icon{transform:rotate(270deg);font-size:1.5em;margin-right:.5em}:host .row{width:100%}\n"] }]
        }], propDecorators: { maxSize: [{
                type: Input
            }], Field: [{
                type: ViewChild,
                args: ['field', { static: false }]
            }], errorControl: [{
                type: ViewChild,
                args: [ErrorMaterialComponent]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb250cm9scy9zcmMvbGliL21hdGVyaWFsLWNvbnRyb2xzL2ZpbGUtdXBsb2FkLWNvbnRyb2wvZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb250cm9scy9zcmMvbGliL21hdGVyaWFsLWNvbnRyb2xzL2ZpbGUtdXBsb2FkLWNvbnRyb2wvZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBVSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDcEUsT0FBTyxFQUFFLDBCQUEwQixFQUFFLE1BQU0sOERBQThELENBQUM7QUFDMUcsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ3BELE9BQU8sRUFBQyxlQUFlLEVBQUcsTUFBTSxtQkFBbUIsQ0FBQTtBQUVuRCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7QUFPbEUsTUFBTSxPQUFPLGtDQUFtQyxTQUFRLDBCQUEwQjtJQU9oRixRQUFRO1FBQ04sUUFBUSxDQUFDLGdCQUFnQixDQUFDLHVFQUF1RSxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRTtZQUU5SSxRQUFRLENBQUMsY0FBYyxDQUFDLGdCQUFnQixDQUFDLEVBQUUsU0FBUyxDQUFDLE1BQU0sQ0FBQyxhQUFhLEVBQUUsc0JBQXNCLEVBQUUsNkJBQTZCLENBQUMsQ0FBQTtZQUNqSSxJQUFJLENBQUMsS0FBSyxDQUFDLGtCQUFrQixDQUFDLG1CQUFtQixD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bnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT25Jbml0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgRmlsZVVwbG9hZENvbnRyb2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi9iYXNlL2ZpbGUtdXBsb2FkLWNvbnRyb2wvZmlsZS11cGxvYWQtY29udHJvbC5jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBGaWxlSW5wdXQgfSBmcm9tICduZ3gtbWF0ZXJpYWwtZmlsZS1pbnB1dCc7XHJcbmltcG9ydCB7VmFsaWRhdGlvblR5cGVzICB9IGZyb20gJy4uLy4uL3ZhbGlkYXRpb25zJ1xyXG5pbXBvcnQge1ZhbGlkYXRpb25Gb3JtfSBmcm9tICcuLi8uLi9keW5hbWljLWZvcm0vaW50ZXJmYWNlcydcclxuaW1wb3J0IHsgRXJyb3JNYXRlcmlhbENvbXBvbmVudCB9IGZyb20gJy4uL2Vycm9yL2Vycm9yLmNvbXBvbmVudCc7XHJcblxyXG5AQ29tcG9uZW50KHtcclxuICBzZWxlY3RvcjogJ3NvZi1maWxlLXVwbG9hZC1jb250cm9sJyxcclxuICB0ZW1wbGF0ZVVybDogJy4vZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuaHRtbCcsXHJcbiAgc3R5bGVVcmxzOiBbJy4vZmlsZS11cGxvYWQtY29udHJvbC1jb21wb25lbnQuc2NzcyddLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgRmlsZVVwbG9hZE1hdGVyaWFsQ29udHJvbENvbXBvbmVudCBleHRlbmRzIEZpbGVVcGxvYWRDb250cm9sQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcclxuXHJcbiAgQElucHV0KCkgbWF4U2l6ZSE6bnVtYmVyXHJcbiAgQFZpZXdDaGlsZCgnZmllbGQnLCB7c3RhdGljOiBmYWxzZX0pIEZpZWxkOiBhbnk7XHJcbiAgQFZpZXdDaGlsZChFcnJvck1hdGVyaWFsQ29tcG9uZW50KSBlcnJvckNvbnRyb2w6IEVycm9yTWF0ZXJpYWxDb21wb25lbnRcclxuXHJcblxyXG4gIG5nT25Jbml0KCk6IHZvaWQge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnbmd4LW1hdC1maWxlLWlucHV0W2RhdGEtc2VsZWN0b3I9XCJtYXQtaW5wdXQtZmlsZVwiXSBpbnB1dFt0eXBlPVwiZmlsZVwiXScpLmZvckVhY2goZSA9PiBlLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgZSA9PiB7XHJcblxyXG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWF0LWlucHV0LWZpbGUnKT8uY2xhc3NMaXN0LnJlbW92ZSgnY2RrLWZvY3VzZWQnLCAnY2RrLWtleWJvYXJkLWZvY3VzZWQnLCAnbWF0LWZvcm0tZmllbGQtc2hvdWxkLWZsb2F0JylcclxuICAgICAgdGhpcy5GaWVsZC5fY2hhbmdlRGV0ZWN0b3JSZWYuX2NkUmVmSW5qZWN0aW5nVmlld1swXT8uY2xhc3NMaXN0LnJlbW92ZSgnbWF0LWZvcm0tZmllbGQtc2hvdWxkLWZsb2F0Jyk7XHJcbiAgICAgIHRoaXMuRmllbGQuX2NoYW5nZURldGVjdG9yUmVmLl9jZFJlZkluamVjdGluZ1ZpZXdbMF0/LmNsYXNzTGlzdC5hZGQoJ21hdC1mb3JtLWZpZWxkLWhpZGUtcGxhY2Vob2xkZXInKTtcclxuICAgIH0pKVxyXG4gIH1cclxuXHJcbiAgb3ZlcnJpZGUgb25JbnB1dCh2YWx1ZTogYW55KTogdm9pZCB7XHJcbiAgICB2YWx1ZSA9IHRoaXMubm9ybWFsaXplVmFsdWUodmFsdWUpO1xyXG5cclxuICAgIHRoaXMuY2hhbmdlVmFsdWUodmFsdWUpO1xyXG5cclxuICAgIGlmKHRoaXMubXVsdGlwbGUgJiYgdmFsdWUubGVuZ3RoID4gMCApIHtcclxuICAgICAgKHRoaXMuRmllbGQuX2NoYW5nZURldGVjdG9yUmVmLl9jZFJlZkluamVjdGluZ1ZpZXdbMF0gYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICB9IFxyXG4gICAgZWxzZSBpZiggdmFsdWUgICYmICF0aGlzLm11bHRpcGxlKSB7XHJcbiAgICAgICh0aGlzLkZpZWxkLl9jaGFuZ2VEZXRlY3RvclJlZi5fY2RSZWZJbmplY3RpbmdWaWV3WzBdIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgfSBcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgZ2V0TWF4U2l6ZVZhbHVlSW5WYWxpZGF0aW9uKHZhbGlkYXRpb25zPzogVmFsaWRhdGlvbkZvcm1bXSl7XHJcbiAgICBpZih2YWxpZGF0aW9ucyl7XHJcbiAgICAgIHJldHVybiB2YWxpZGF0aW9ucy5maW5kKHg9PngudHlwZT09IFZhbGlkYXRpb25UeXBlcy5NYXhGaWxlU2l6ZSk/LnZhbHVlXHJcbiAgICB9XHJcbiAgICBlbHNlIHJldHVybiAwXHJcbiAgfVxyXG5cclxuICBnZXRGaWxlSW5wdXRGcm9tVmFsdWUoKTogRmlsZUlucHV0IHtcclxuICAgIGlmICh0aGlzLnZhbHVlIGluc3RhbmNlb2YgRmlsZSlcclxuICAgICAgcmV0dXJuIG5ldyBGaWxlSW5wdXQoW3RoaXMudmFsdWVdKTtcclxuICAgIGVsc2VcclxuICAgICAgcmV0dXJuIG5ldyBGaWxlSW5wdXQodGhpcy52YWx1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRGaWxlc05hbWUoKTogc3RyaW5nW10ge1xyXG4gICAgY29uc3QgZmlsZXMgPSB0aGlzLmdldEZpbGVJbnB1dEZyb21WYWx1ZSgpO1xyXG4gICAgcmV0dXJuIGZpbGVzLmZpbGVOYW1lcz8gZmlsZXMuZmlsZU5hbWVzLnNwbGl0KCcsJykgOiBbXTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUl0ZW0oa2V5OiBzdHJpbmcpIHtcclxuICAgIGlmKCB0aGlzLm11bHRpcGxlICl7XHJcbiAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLmZpbHRlciggKGY6IEZpbGUpID0+IGYubmFtZSAhPSBrZXkpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLnZhbHVlID0gbnVsbFxyXG4gICAgfVxyXG5cclxuICAgIGlmKCAhdGhpcy52YWx1ZSB8fCB0aGlzLnZhbHVlLmxlbmd0aCA8IDEgKSB7XHJcbiAgICAgICh0aGlzLkZpZWxkLl9jaGFuZ2VEZXRlY3RvclJlZi5fY2RSZWZJbmplY3RpbmdWaWV3WzBdIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ2lubGluZS1ibG9jayc7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIjxtYXQtZm9ybS1maWVsZCAgYXBwZWFyYW5jZT1cIm91dGxpbmVcIiAjZmllbGQgPlxyXG4gIDxtYXQtbGFiZWwgW25nQ2xhc3NdPVwie1xyXG4gICAgJ3JlcXVpcmVkLWxhYmVsJzogaXNSZXF1aXJlZCxcclxuICAgICd0ZXh0LWVycm9yJzogRXNJbnZhbGlkb1xyXG4gIH1cIj5cclxuICA8bWF0LWljb24gbWF0U3VmZml4PmF0dGFjaG1lbnQ8L21hdC1pY29uPlxyXG4gIHt7IGxhYmVsIH19XHJcbiAgPC9tYXQtbGFiZWw+XHJcblxyXG4gIDxuZ3gtbWF0LWZpbGUtaW5wdXQgXHJcbiAgICBkYXRhLXNlbGVjdG9yPVwibWF0LWlucHV0LWZpbGVcIlxyXG4gICAgbWF0SW5wdXRcclxuICAgIGNsYXNzPVwiZm9ybS1jb250cm9sXCJcclxuICAgIFtkaXNhYmxlZF09XCJkaXNhYmxlZFwiXHJcbiAgICB0eXBlPVwiZmlsZVwiXHJcbiAgICBbbXVsdGlwbGVdPVwiISFtdWx0aXBsZVwiXHJcbiAgICBbdmFsdWVdPVwiZ2V0RmlsZUlucHV0RnJvbVZhbHVlKClcIlxyXG4gICAgW2FjY2VwdF09XCJhY2NlcHRcIlxyXG4gICAgKGNoYW5nZSk9XCJvbklucHV0KCAhIW11bHRpcGxlID8gJGFueSgkZXZlbnQudGFyZ2V0KS5maWxlcyA6ICRhbnkoJGV2ZW50LnRhcmdldCkuZmlsZXNbMF0gKVwiPlxyXG4gIDwvbmd4LW1hdC1maWxlLWlucHV0PlxyXG5cclxuICBcclxuPC9tYXQtZm9ybS1maWVsZD5cclxuXHJcbjxkaXYgICpuZ0lmPVwiZ2V0RmlsZXNOYW1lKCkubGVuZ3RoID4gMFwiIGNsYXNzPVwicm93XCI+XHJcbiAgPGRpdj5cclxuICAgIDxtYXQtY2hpcC1saXN0ICpuZ0Zvcj1cImxldCBmaWxlIG9mIGdldEZpbGVzTmFtZSgpXCI+XHJcbiAgICAgIDxtYXQtY2hpcCA+XHJcbiAgICAgICAge3sgZmlsZSB9fVxyXG4gICAgICAgIDxidXR0b24gbWF0Q2hpcFJlbW92ZSAoY2xpY2spPVwiZGVsZXRlSXRlbShmaWxlKVwiPlxyXG4gICAgICAgICAgPG1hdC1pY29uPmNhbmNlbDwvbWF0LWljb24+XHJcbiAgICAgICAgPC9idXR0b24+XHJcbiAgICAgIDwvbWF0LWNoaXA+XHJcbiAgICA8L21hdC1jaGlwLWxpc3Q+XHJcbiAgPC9kaXY+XHJcbjwvZGl2PlxyXG5cclxuXHJcblxyXG48c29mLWVycm9yIFtjb250cm9sSW52YWxpZG9dPVwiRXNJbnZhbGlkb1wiIFtsYWJlbF09XCJsYWJlbFwiIFtlcnJvcnNdPVwiZXJyb3JzXCI+PC9zb2YtZXJyb3I+XHJcbiJdfQ==